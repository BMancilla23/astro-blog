---
// src/pages/blog/[page].astro
import Pagination from "@/components/Pagination.astro";
import PostGrid from "@/components/PostGrid.astro";
import TypedPostCard from "@/components/TypedPostCard.astro";
import MainLayout from "@/layouts/MainLayout.astro";
import type { GetStaticPaths, Page } from "astro";
import type { CollectionEntry } from "astro:content";
import { getCollection } from "astro:content";

export const getStaticPaths: GetStaticPaths = async ({ paginate }) => {
  const posts = await getCollection("blog", ({ data }) => !!data.date);
  posts.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

  const POSTS_PER_PAGE = 2;

  return paginate(posts, {
    pageSize: POSTS_PER_PAGE,
  });
};

const { page } = Astro.props as {
  page: Page<CollectionEntry<"blog">>;
};
---

<MainLayout>
  <!--  <PostGrid posts={page.data} title="Bryan's Blog" /> -->

  <PostGrid title="Bryan's Blog">
    {page.data.map((post) => <TypedPostCard post={post} showAuthor />)}
  </PostGrid>

  <Pagination prev={page.url.prev} next={page.url.next} />
</MainLayout>
